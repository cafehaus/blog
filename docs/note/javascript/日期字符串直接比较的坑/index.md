# 日期字符串直接比较的坑

前后端传参或者接受日期时间一般都会格式化成固定格式的字符串，如果格式是规范的 YYYY-MM-DD HH:mm:ss，其实是可以直接比较的，但是如果不规范直接字符串相比较就很容易出问题。

```js
let a = '2022-02-28 10:00:00'
let b = '2022-2-28 10:00:00'
let c = '2022-03-01 10:00:00'

c > a // true
c > b // false
```
刚开始我第一反应想到的是隐式转换埋下的坑，其实并不是，直接将上面的日期字符串 Number 的结果发现都是 null，字符串和字符串相比较并不会先转成数值。

**字符串相比较：**
* 如果字符串长度是0的情况，就可以直接比较出大小。
* 如果长度不为0，是按每个字符的“Unicode 编码”大小进行比较，直到分出大小为止，一句话概括就是按照字典序进行对比

上面的 c > b 之所以跟咱的直觉相悖，因为逐一比到月份时，2和3月前面的0比较，对应的Unicode码（charCodeAt() 方法可返回指定位置的字符的 Unicode 编码，这个返回值是 0 - 65535 之间的整数）：
* 2：50
* 0：48

即使不看Unicode码，直接看数值我们也能看出来2和0谁大了，最后建议日期比较还是不要这样直接比较，借助第三方库像dayjs提供的方法去比较比较靠谱。

::: tip 提示
unicode：统一码（万国码、单一码），是国际组织制定的可以容纳世界上所有文字和符号的字符编码方案
ASCII码：大多数计算机采用ASCII码（美国标准信息交换码），它是表示所有大小写字母、数字、标点符号和控制字符的7位编码方案。统一码（Unicode）包含ASCII码，'\u0000'到'\u007F'对应全部128个ACSII字符

所以在js里其实是可以用中文做变量名，但是一般不建议使用超出ASCII码的字符，unicode水很深
:::

**字符串相比较并不会隐式转换**

字符串和字符串相比较并不会出现隐式转换，这一点尤其在数值型字符串相比较时要注意
```js
let a = '0109'
let b = '109'
let c = '11'

c < a // false
c < b // false
```
像上面的数值型字符串比较时，切记要先转换成数值，然后再来比较。

**总结**
1、数值和数值可以直接比较，不会出问题
2、数值字符串和数值相比较，数值字符串会自动先转成数值再比较，所以也不会有问题
3、字符串和字符串相比较，这里就容易出问题，一定切记要先转成数值再比较（可以直接用 + 转成数值）

```js
// 2022年6月21日又在项目中踩到这个坑
// 一个日期天数的校验比较，要求前一个要小于或等于后一个
// 因为页面上的初始数据是其他地方同步过来的，如下直接比较，校验一直不过
let a = '4'
let b = '10'

a > b // true
```

